[ZONE WGCAL:WGCAL_HTMLHEAD]

<!-- Globals variables -->
<script type="text/javascript">
var me = { id:[freedomId], title:'[freedomTitle]' };
var colpick = new ColorPicker();
var calRessMenuUrl="[CORE_STANDURL]sole=Y&app=WGCAL&action=WGCAL_GETRESSMENU&rid=";
var calCurrentEdit = { id:[ceId], title:'[ceTitle]', color:'[ceColor]' };
var calRessources = new Array();

var toolbarOpen = true;
var toolbarWidth = [toolbarwidth];
var toolbarOpenImg = '[IMG:wm-nperiod.gif]';
var toolbarCloseImg = '[IMG:wm-pperiod.gif]';
function hideShowToolbar(imbut) {
  var fwgcal = parent.document.getElementById('wgcal');
  if (fwgcal) {
    if (!toolbarOpen) {
      fwgcal.cols=''; 
      fwgcal.cols=toolbarWidth+'pt,*';
      fwgcal.style.display = 'block';
      imbut.src = toolbarCloseImg;
      toolbarOpen = true;
    } else {
      fwgcal.cols=''; 
      fwgcal.cols='0pt,*';
      imbut.src = toolbarOpenImg;
      toolbarOpen = false;
    }
  }    
} 
</script>

<form style="display:none" id="f_initress" target="wgcal_toolbar" name="initress" method="POST" action="[CORE_STANDURL]&app=WGCAL&action=WGCAL_INITRESSOURCES"></form>
<form style="display:none" id="ftoolsvis" target="wgcal_hidden" name="ftoolsvis" method="POST" action="[CORE_STANDURL]&app=WGCAL&action=WGCAL_SETTOOLSTATE"><input id="toolsvis" name="toolsvis" type="hidden" value=""></form>
<div title="[TEXT:click here to refresh toolbar]" onclick="SaveFrameWidth(); document.location.reload(true)" class="wWhoAmI">
<table width="100%" cellspacing="0"><tr>
<td align="center"><img src="[IMG:wm-reloadsync.gif]" height="16px">
<td align="center"><div><span style="font-weight:bold">[owner]</span>&nbsp;<span id="todaydate" style="font-size:80%">--</span></div>
[IF LSYNC]<div style="[lsyncstyle];font-size:80%"> ([TEXT:last sync] [lastsync])</div>[ENDIF LSYNC]</td></tr></table>
</div>

<!-- Rendez-vous en attente -->
<table id="bwaitrv" onclick="getWaitingRv()" class="wToolButtonUnSelect" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td align="left"><img style="vertical-align:middle;" id="owaitrv" src="[IMG:minus.gif]">&nbsp;[TEXT:waiting rv] (<span id="rvcount">[RVCOUNT]</span>)</td>
<td align="right"><input style="cursor:pointer" type="checkbox" id="alertwrv" name="alertwrv" onchange="setwrvalert()" [alertwrv] title="[TEXT:alert for new event ?]">&nbsp;</td>
</tr>
</table>
<div id='vwaitrv' class="wToolArea" style="border:0px; margin:0px; padding:0px 2px 0px 10px; overflow:auto"></div>

<!-- search zone -->
[IF SHOWSEARCH] [ZONE WGCAL:SEARCH] [ENDIF SHOWSEARCH]


 [IF VContactSTop]<iframe id="contactss" name="contactss" style="border:0px; width:100%; height:auto; position:relative;" src="[CORE_STANDURL]&app=USERCARD&action=FADDBOOK_SPEEDSEARCH"></iframe>[ENDIF VContactSTop]

[IF NavDate]
<table id="bnav" class="[bnav]" width="100%" cellspacing="0" cellpadding="0">
<tr valign="center">
<td id="inav" style="text-align:left;" onclick="WGCalChangeVisibility('nav','[IMG:plus.gif]','[IMG:minus.gif]');"><img style="vertical-align:middle;" id="onav" src="[IF onav][IMG:minus.gif][ENDIF onav][IFNOT onav][IMG:plus.gif][ENDIF onav]">&nbsp;[TEXT:date selector]</td>
<td align="right"><input id="chk2cal" type="checkbox" onclick="v=(this.checked?'':'none'); document.getElementById('cal2').style.display=v;" title="[TEXT:display two months]" style="cursor:pointer">&nbsp;</td>
</tr>
</table>
<div align="center" class="wToolArea" width="100%" id="vnav" style="overflow:auto; display:[vnav]">
<script type="text/javascript">Calendar.setup({
        ifFormat       :    "%s",       // format of the input field
        showsTime      :    false,            // will display a time selector
        firstDay       :    1,
        date           :    new Date([CmTIME]),
        weekNumbers    :    true,
        flat           :    "vnav",
        flatCallback   :    WGCalSetDate
    });</script>
<div align="center" width="100%" id="cal2" style="display:none"><script type="text/javascript">Calendar.setup({
        ifFormat       :    '%s',       // format of the input field
        showsTime      :    false,            // will display a time selector
        singleClick    :    false,           // double-click mode
        firstDay       :    1,
        date           :    new Date([Cm2TIME]),
        weekNumbers    :    true,
        flat           :    'cal2',
        flatCallback   :    WGCalSetDate   
    });</script></div>
</div>
[ENDIF NavDate]

<!-- LISTE DES AGENDAS -->

<table id="bcals" class="[bcals]"  width="100%" cellspacing="0" cellpadding="0">
<tr valign="center">
<td id="icals" onclick="WGCalChangeVisibility('cals','[IMG:plus.gif]','[IMG:minus.gif]');" align="left"><img style="vertical-align:middle;" id="ocals" src="[IF ocals][IMG:minus.gif][ENDIF ocals][IFNOT ocals][IMG:plus.gif][ENDIF ocals]">&nbsp;[TEXT:calendar selector]</td>
<td align="right">
<img id="caldiraccess" class="wSmallButton"  onclick="sic=document.getElementById('icalselframe'); if (sic.style.visibility!='hidden') { this.className='wSmallButton'; sic.style.display = 'none'; sic.style.visibility = 'hidden'; } else { sic.src='[CORE_STANDURL]&app=WGCAL&action=WGCAL_SEARCHICAL'; this.className='wSmallButtonPushed'; sic.style.display = ''; sic.style.visibility = 'visible'; } "
 height="15" src="[IMG:wm-caldirectaccess.gif]" title="[TEXT:calendar direct access]">
<img id="resssel" class="wSmallButton"  onclick="picker = subwindow(300, 400, 'CalPicker', '[CORE_STANDURL]&app=WGCAL&action=WGCAL_RESSPICKER_MAIN&updt=memoress');" height="15" src="[IMG:wm-attendees.gif]" title="[TEXT:modify the list]">
<img id="resssel" class="wSmallButton" onclick="fcalUpdateCalendar()" height="15" src="[IMG:wm-refreshcal.gif]" title="[TEXT:update calendar]">
</td>
</tr>
</table>
<iframe id="icalselframe" style="border:0px; width:100%; height:100px; position:relative; display:none; visibility:hidden;" src="about:blank">
</iframe>

<div id="vcals"  class="wToolArea" style="overflow:auto;" >
<table style="border:0px; margin:0px; padding:0px; width:100%;" cellspacing="0" cellpadding="0">
<thead></thead>
<tbody id="tabress">
<tr style="display:none; border:0px;" id="trsample">
<td style="width:10px; border:0px"><input type="radio" name="agdsel" id="agd%RID%" title="[TEXT:select to edit agenda for] %RDESCR%" onclick="calCurrentEdit = { id:%RID%, title:'%RDESCR%', color:document.getElementById('cp%RID%').style.backgroundColor }; fcalChangeUPref(-1, 'WGCAL_U_DCALEDIT', %RID%); if (document.getElementById('%RID%').className!='WGCRessSelected') { var cdis=confirm('Voulez-vous afficher cet agenda ?'); if (cdis) { vuvRessource(%RID%); } }"></td>
<td onclick="curRessource=%RID%; colpick.show('cp%RID%'); return false;" width="6px" id="cp%RID%" name="cp%RID%" style="cursor:pointer; border: 1px outset">&nbsp;</td>
<td nowrap id="%RID%" style="cursor:crosshair" 
    onmouseover="if (this.className=='WGCRessSelected') return; this.className='WGCRessOver'" 
    onmouseout="if (this.className=='WGCRessSelected') return; this.className='WGCRessDefault'"
    onclick="vuvRessource(this.id); "
    onContextMenu="viewmenu(event,calRessMenuUrl+this.id); return false">
&nbsp;<img id="im%RID%" height="15px" align="absbottom" src="%RICON%">&nbsp;%RDESCR%&nbsp;<img id="imro%RID%" height="10px" align="absbottom" title="[TEXT:read only calendar]" src="[IMG:wm-readonly.gif]">
</td>
</tr>
</tbody>

<tfoot>
<tr><td colspan="2"></td></tr>
</tfoot>
</table>
</div>

 
[IF VContactSBottom]<iframe id="contactss" name="contactss" style="border:0px; width:100%; height:auto; position:relative;" src="[CORE_STANDURL]&app=USERCARD&action=FADDBOOK_SPEEDSEARCH"></iframe>[ENDIF VContactSBottom]


<script type="text/javascript">

var  toolList = new Array( [IF NavDate]'nav',[ENDIF NavDate] 'cals', 'waitrv', 'todo', 'contacts');

[BLOCK L_RESS]
fcalDrawRessource('[RDESCR]', '[RID]', '[RICON]', '[RCOLOR]', '[RSTYLE]', [RSTATE], [ROMODE], [DG_HAVE], [DG_SELECTED] );[ENDBLOCK L_RESS]
fcalSaveRessources();
var MyFreedomId = [MyFreedomId];
[IF ReloadAgenda]fcalUpdateCalendar();[ENDIF ReloadAgenda]

colpick.writeDiv();

// Init waiting event zone
getWaitingRv();

</script>



[ZONE WGCAL:WGCAL_HTMLFOOT]
